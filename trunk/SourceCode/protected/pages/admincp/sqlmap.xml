<?xml version="1.0" encoding="utf-8"?>
<sqlMapConfig>
	<select id="ViewItemsBySupplier" parameterClass="array" resultMap="OrderItemRecord">
		<![CDATA[
			SELECT oi.* FROM tbl_order_item oi
			LEFT JOIN tbl_order o on oi.order_id = o.order_id
			LEFT JOIN tbl_product p on oi.product_id = p.product_id
			LEFT JOIN tbl_brand b on p.brand_id = b.brand_id
			LEFT JOIN tbl_manufacturer m on p.mf_id = m.mf_id
			WHERE oi.order_id > 0
			$ADDITIONAL_CONDITION$
			ORDER BY $ORDER_BY$
		]]>
	</select>
	<select id="SalesReport" parameterClass="array" resultMap="OrderRecord">
		<![CDATA[
			SELECT DISTINCT o.* FROM tbl_order o
			LEFT JOIN tbl_order_history oh ON o.order_id = oh.order_id
			LEFT JOIN tbl_order_status os ON oh.order_status_code = os.status_code
			WHERE o.order_id > 0
			$ADDITIONAL_CONDITION$
			ORDER BY $ORDER_BY$
		]]>
	</select>
	<select id="ProductReport" parameterClass="array" resultMap="OrderItemRecord">
		<![CDATA[
			SELECT oi.*, SUM(oi.quantity) AS total_quantity FROM tbl_order_item oi
			LEFT JOIN tbl_order o ON oi.order_id = o.order_id
			LEFT JOIN tbl_product p ON oi.product_id = p.product_id
			LEFT JOIN tbl_product_cat_xref pcx ON p.product_id = pcx.product_id
			LEFT JOIN tbl_brand b ON p.brand_id = b.brand_id
			WHERE o.order_id > 0
			$ADDITIONAL_CONDITION$
			GROUP BY oi.product_id, oi.prop_id
			ORDER BY $ORDER_BY$
		]]>
	</select>
	<select id="CustomerReport" parameterClass="array" resultMap="OrderRecord">
		<![CDATA[
			SELECT o.*, COUNT(o.order_id) AS total_order, SUM(o.total) AS total_amount
			FROM tbl_order o
			LEFT JOIN tbl_user u ON o.user_id = u.user_id
			WHERE o.order_id > 0
			$ADDITIONAL_CONDITION$
			GROUP BY u.user_id
			ORDER BY $ORDER_BY$
		]]>
	</select>
	<select id="BrowseProduct" parameterClass="array" resultMap="ProductRecord">
		<![CDATA[
			SELECT DISTINCT p.* FROM tbl_product p 
			LEFT JOIN tbl_product_cat_xref pcx ON p.product_id = pcx.product_id 
			LEFT JOIN tbl_category c ON pcx.cat_id = c.cat_id 
			LEFT JOIN tbl_brand b ON p.brand_id = b.brand_id
			WHERE p.product_id > 0 AND p.product_publish = 1 
			$ADDITIONAL_CONDITION$
			ORDER BY $ORDER_BY$
		]]>
	</select>
	<select id="FavouriteProduct" parameterClass="array" resultMap="ProductRecord">
		<![CDATA[
			SELECT DISTINCT p.* FROM tbl_product p
			LEFT JOIN tbl_order_item oi ON oi.product_id = p.product_id
			LEFT JOIN tbl_order o ON o.order_id = oi.order_id
			WHERE o.user_id = #userId#
			ORDER BY oi.quantity DESC, oi.c_date DESC
		]]>
	</select>
	<select id="GetOrderItemByOrderID" parameterClass="int" resultMap="OrderItemRecord">
		<![CDATA[
			SELECT oi.* FROM tbl_order_item oi
			LEFT JOIN tbl_order o ON oi.order_id = o.order_id
			LEFT JOIN tbl_product p ON oi.product_id = p.product_id
			LEFT JOIN tbl_brand b ON p.brand_id = b.brand_id
			WHERE o.order_id = #orderId#
			ORDER BY brand_name
		]]>
	</select>
	<resultMap id="ProductRecord" class="ProductRecord">
		<result property="ID" column="product_id" />
		<result property="MfID" column="mf_id" />
		<result property="BrandID" column="brand_id" />
		<result property="DiscountID" column="discount_id" />
		<result property="SKU" column="product_sku" />
		<result property="Alias" column="product_alias" />
		<result property="Name" column="product_name" />
		<result property="FreeText1" column="product_free_text_1" />
		<result property="FreeText2" column="product_free_text_2" />
		<result property="Brief" column="product_brief" />
		<result property="Description" column="product_desc" />
		<result property="ImagePath" column="product_image" />
		<result property="ThumbnailPath" column="product_thumb" />
		<result property="RewardPoints" column="product_reward_points" />
		<result property="IsBestSeller" column="product_best_seller" />
		<result property="IsHotDeal" column="product_hot_deal" />
		<result property="IsNewArrival" column="product_new_arrival" />
		<result property="IsPublished" column="product_publish" />
		<result property="Ordering" column="product_order" />
		<result property="AvailableDate" column="product_available_date" />
		<result property="CreateDate" column="c_date" />
		<result property="ModifyDate" column="m_date" />
	</resultMap>
	<resultMap id="OrderItemRecord" class="OrderItemRecord">
		<result property="ID" column="item_id" />
		<result property="OrderID" column="order_id" />
		<result property="ProductID" column="product_id" />
		<result property="PropertyID" column="prop_id" />
		<result property="DiscountName" column="discount_name" />
		<result property="DiscountAmount" column="discount_amount" />
		<result property="DiscountIsPercent" column="discount_is_percent" />
		<result property="UnitPrice" column="unit_price" />
		<result property="Quantity" column="quantity" />
		<result property="Subtotal" column="subtotal" />
		<result property="Counter" column="gen_counter" />
		<result property="CreateDate" column="c_date" />
		<result property="ModifyDate" column="m_date" />
		<result property="TotalQuantity" column="total_quantity" />
	</resultMap>
	<resultMap id="OrderRecord" class="OrderRecord">
		<result property="ID" column="order_id" />
		<result property="Num" column="order_num" />
		<result property="UserID" column="user_id" />
		<result property="BTitle" column="b_title" />
		<result property="BCompanyName" column="b_company_name" />
		<result property="BFirstName" column="b_first_name" />
		<result property="BLastName" column="b_last_name" />
		<result property="BAddress1" column="b_address_1" />
		<result property="BAddress2" column="b_address_2" />
		<result property="BCity" column="b_city" />
		<result property="BState" column="b_state" />
		<result property="BCountryCode" column="b_country_code" />
		<result property="BZipCode" column="b_zip_code" />
		<result property="BPhone1" column="b_phone_1" />
		<result property="BPhone2" column="b_phone_2" />
		<result property="BFax" column="b_fax" />
		<result property="BTitle" column="b_title" />
		<result property="SCompanyName" column="s_company_name" />
		<result property="SFirstName" column="s_first_name" />
		<result property="SLastName" column="s_last_name" />
		<result property="SAddress1" column="s_address_1" />
		<result property="SAddress2" column="s_address_2" />
		<result property="SCity" column="s_city" />
		<result property="SState" column="s_state" />
		<result property="SCountryCode" column="s_country_code" />
		<result property="SZipCode" column="s_zip_code" />
		<result property="SPhone1" column="s_phone_1" />
		<result property="SPhone2" column="s_phone_2" />
		<result property="Subtotal" column="subtotal" />
		<result property="TaxAmount" column="tax_amount" />
		<result property="ShippingMethodID" column="shipping_method_id" />
		<result property="ShippingAmount" column="shipping_amount" />
		<result property="EstDeliveryDate" column="est_delivery_date" />
		<result property="CouponCode" column="coupon_code" />
		<result property="CouponAmount" column="coupon_amount" />
		<result property="RewardPointsRebate" column="reward_points_rebate" />
		<result property="Deliverer" column="deliverer_name" />
		<result property="TotalPacks" column="total_packs" />
		<result property="Total" column="total" />
		<result property="Currency" column="currency" />
		<result property="IPAddress" column="ip_address" />
		<result property="Comments" column="comments" />
		<result property="CreateDate" column="c_date" />
		<result property="ModifyDate" column="m_date" />
		<result property="TotalOrder" column="total_order" />
		<result property="TotalAmount" column="total_amount" />
	</resultMap>
</sqlMapConfig>